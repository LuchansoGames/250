function preload(){game.stage.backgroundColor=backgroundColor,game.scale.pageAlignHorizontally=!0,game.scale.pageAlignVertically=!0,game.load.audio("music",["sounds/music.mp3","sounds/music.ogg"]),game.load.audio("coin",["sounds/coin.wav","sounds/coin.mp3"]),game.load.audio("jump",["sounds/jump.wav","sounds/jump.mp3"]),game.load.audio("die",["sounds/die.wav","sounds/die.mp3"]),game.load.image("square","img/square.png"),game.load.image("enemy","img/enemy.png"),game.load.image("square-particle","img/square-particle.png"),game.load.image("enemy-particle","img/enemy-particle.png"),game.load.image("instruction","img/instruction.png"),game.load.spritesheet("volume","img/volume-spritesheet.png",96,96)}function create(){upKey=game.input.keyboard.addKey(Phaser.Keyboard.W),upKey.onDown.add(up,this),upKey=game.input.keyboard.addKey(Phaser.Keyboard.UP),upKey.onDown.add(up,this),downKey=game.input.keyboard.addKey(Phaser.Keyboard.S),downKey.onDown.add(down,this),downKey=game.input.keyboard.addKey(Phaser.Keyboard.DOWN),downKey.onDown.add(down,this),leftKey=game.input.keyboard.addKey(Phaser.Keyboard.A),leftKey.onDown.add(left,this),leftKey=game.input.keyboard.addKey(Phaser.Keyboard.LEFT),leftKey.onDown.add(left,this),rightKey=game.input.keyboard.addKey(Phaser.Keyboard.D),rightKey.onDown.add(right,this),rightKey=game.input.keyboard.addKey(Phaser.Keyboard.RIGHT),rightKey.onDown.add(right,this),addScoreLable(),square=game.add.sprite(0,0,"square"),square.tint=playerColor,square.width=squareSize,square.height=squareSize,square.x=game.world.centerX,square.y=game.world.centerY,square.anchor.setTo(.5,.5),coin=game.add.sprite(-100,-100,"square"),coin.tint=coinColor,coin.width=coinSize,coin.height=coinSize,coin.anchor.setTo(.5,.5);var e=game.add.tween(coin).to({angle:360},1e3,"Linear",!0);e.repeat(-1,0),enemies=game.add.group(),enemies.enableBody=!0,enemies.createMultiple(20,"enemy");var t=game.add.sprite(0,0,"instruction");t.x=game.world.centerX-t.width/2,t.y=game.world.height-t.height-margin,nextEnemy=game.time.now,setTimeout(function(){game.add.tween(t).to({alpha:0},instructionFadeTime).start()},instructionShowTime),addGameName(),addSounds(),addVolumeButton(),addCoin(),addEmitter();var a=game.add.graphics(0,0);drawBorder(a)}function update(){overlap(square,coin)&&takeCoin(),enemies.forEach(function(e){overlap(square,e)&&squareDie(e)}),console.log(enemies.hash[0].inWorld),spawnEnemies()}function overlap(e,t){return e.getBounds().width!==e.width?!1:Phaser.Rectangle.intersects(e.getBounds(),t.getBounds())}function render(){var e=square.getBounds(),t=coin.getBounds();Phaser.Rectangle.intersection(e,t)}function drawBorder(e){e.lineStyle(5,1713022),e.drawRect(game.world.centerX-135,game.world.centerY-135,270,270)}function up(){if(!isMoving){settings.muted||jumpSound.play();var e,t=square.y-90,a=game.world.centerY-90;a>t?(t+=distance,e=game.add.tween(square).to({y:t},37.5).to({y:square.y},37.5).start()):e=game.add.tween(square).to({y:t},squareMoveTime).start(),isMoving=!0,e.onComplete.add(function(){isMoving=!1})}}function down(){if(!isMoving){settings.muted||jumpSound.play();var e,t=square.y+90,a=game.world.centerY+90;t>a?(t-=distance,e=game.add.tween(square).to({y:t},37.5).to({y:square.y},37.5).start()):e=game.add.tween(square).to({y:t},squareMoveTime).start(),isMoving=!0,e.onComplete.add(function(){isMoving=!1})}}function left(){if(!isMoving){settings.muted||jumpSound.play();var e,t=square.x-90,a=game.world.centerX-90;a>t?(t+=distance,e=game.add.tween(square).to({x:t},37.5).to({x:square.x},37.5).start()):e=game.add.tween(square).to({x:t},squareMoveTime).start(),isMoving=!0,e.onComplete.add(function(){isMoving=!1})}}function right(){if(!isMoving){settings.muted||jumpSound.play();var e,t=square.x+90,a=game.world.centerX+90;t>a?(t-=distance,e=game.add.tween(square).to({x:t},37.5).to({x:square.x},37.5).start()):e=game.add.tween(square).to({x:t},squareMoveTime).start(),isMoving=!0,e.onComplete.add(function(){isMoving=!1})}}function addGameName(){var e={font:"48px Arial",fill:"#fff",boundsAlignH:"center",boundsAlignV:"middle"};text=game.add.text(0,0,"250+",e),text.x=game.world.centerX-text.width/2,text.y=100}function addScoreLable(){var e={font:"100px Arial",fill:"#fff",boundsAlignH:"center",boundsAlignV:"middle"};scoreLable=game.add.text(0,0,"0",e),scoreLable.anchor.setTo(.5,.5),scoreLable.x=game.world.centerX,scoreLable.y=game.world.centerY,scoreLable.alpha=.25}function addSounds(){music=game.add.audio("music"),music.loop=!0,music.volume=0,coinSound=game.add.audio("coin"),coinSound.volume=.36,jumpSound=game.add.audio("jump"),jumpSound.volume=.3,dieSound=game.add.audio("die"),dieSound.volume=.3,settings.muted||music.play(),game.add.tween(music).to({volume:.6},musicUp).start()}function squareDie(e){e.alive&&(isDie=!0,e.kill(),this.score=0,this.scoreLable.text=this.score,emitter2.x=e.x,emitter2.y=e.y,emitter2.start(!0,200,null,20),settings.muted||dieSound.play(),game.time.events.add(300,function(){isDie=!1},this))}function takeCoin(){if(!coinTaking){coinTaking=!0,emitter.x=coin.x,emitter.y=coin.y,emitter.start(!0,800,null,20),settings.muted||coinSound.play(),updateScore();game.add.tween(coin).to({width:0,height:0},100).start();game.time.events.add(coinInterval,addCoin,this)}}function updateScore(){score++,scoreLable.text=score}function addEmitter(){emitter=game.add.emitter(0,0),emitter.makeParticles("square-particle"),emitter.setXSpeed(-150,150),emitter.setYSpeed(-150,150),emitter.setScale(2,0,2,0,800),emitter2=game.add.emitter(0,0),emitter2.makeParticles("enemy-particle"),emitter2.setXSpeed(-150,150),emitter2.setYSpeed(-150,150),emitter2.setScale(2,0,2,0,800)}function spawnEnemies(){if(!(game.time.now<nextEnemy)){var e=2e3,t=500,a=30,n=Math.max(e-(e-t)*score/a,t);nextEnemy=game.time.now+n,addEnemy()}}function addEnemy(){var e=enemies.getFirstDead();if(e){var t=[{x:-25,y:game.world.centerY-90},{x:-25,y:game.world.centerY},{x:-25,y:game.world.centerY+90},{x:game.width+25,y:game.world.centerY-90},{x:game.width+25,y:game.world.centerY},{x:game.width+25,y:game.world.centerY+90},{x:game.world.centerX-90,y:-25},{x:game.world.centerX,y:-25},{x:game.world.centerX+90,y:-25},{x:game.world.centerX-90,y:game.height+25},{x:game.world.centerX,y:game.height+25},{x:game.world.centerX+90,y:game.height+25}],a=2,n=100,o=t[game.rnd.integerInRange(0,t.length-1)];e.reset(o.x,o.y),o.x>game.width?e.body.velocity.x=-n*a:o.x<0?e.body.velocity.x=n*a:o.y>game.height?e.body.velocity.y=-n*a:o.y<0&&(e.body.velocity.y=n*a),e.anchor.setTo(.5),e.outOfBoundsKill=!0,e.checkWorldBounds=!0}}function addVolumeButton(){var e=1;settings.muted&&(e=0),soundButton=game.add.button(5,5,"volume",volumeStateChange,this,e,e,e),soundButton.width=48,soundButton.height=48}function volumeStateChange(){0===soundButton.frame?(soundButton.setFrames(1,1,1),music.paused?music.resume():music.play(),settings.muted=!1):1===soundButton.frame&&(soundButton.setFrames(0,0,0),music.pause(),settings.muted=!0),saveSettings(settings)}function saveSettings(e){localStorage.setItem("250-settings",JSON.stringify(e))}function loadSettings(){return JSON.parse(localStorage.getItem("250-settings"))||{muted:!1}}function addCoin(){var e=game.rnd.integerInRange(0,2),t=game.rnd.integerInRange(0,2);e=game.world.centerX-90+90*e,t=game.world.centerY-90+90*t,coin.x=e,coin.y=t,game.add.tween(coin).to({width:coinSize,height:coinSize},100).start(),coinTaking=!1}var game=new Phaser.Game(600,900,Phaser.AUTO,"",{preload:preload,create:create,update:update,render:render});const margin=20,squareSize=50,coinSize=24,distance=70,backgroundColor=2635155,playerColor=15662913,coinColor=2201331,enemyColor=16732754,squareMoveTime=75,instructionFadeTime=2e3,instructionShowTime=3e3,musicUp=7500,coinInterval=500;var square,coin,isMoving=!1,isDie=!1,soundButton,score=0,bestScore=0,nextEnemy,enemies,coinSound,jumpSound,dieSound,music,settings=loadSettings(),upKey,downKey,leftKey,rightKey,takingCoin=!1;